{"ast":null,"code":"import React from 'react';\nimport { PopupStack } from '@workday/canvas-kit-popup-stack';\nexport var useCloseOnOutsideClick = function (model, elemProps) {\n  if (elemProps === void 0) {\n    elemProps = {};\n  }\n\n  var onClick = React.useCallback(function (event) {\n    if (!model.state.stackRef.current) {\n      return;\n    }\n\n    var elements = PopupStack.getElements().filter(function (e) {\n      return e.getAttribute('data-behavior-click-outside-close') === 'topmost';\n    }).sort(function (a, b) {\n      return Number(a.style.zIndex) - Number(b.style.zIndex);\n    });\n\n    if (elements.length && elements[elements.length - 1] === model.state.stackRef.current && !PopupStack.contains(model.state.stackRef.current, event.target)) {\n      model.events.hide({\n        event: event\n      });\n    }\n  }, [model.state.stackRef, model.events]);\n  var visible = model.state.visibility !== 'hidden';\n  React.useLayoutEffect(function () {\n    var _a;\n\n    if (!visible) {\n      return;\n    }\n\n    document.addEventListener('mousedown', onClick);\n    (_a = model.state.stackRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-behavior-click-outside-close', 'topmost');\n    return function () {\n      document.removeEventListener('mousedown', onClick);\n    };\n  }, [model.state.stackRef, visible, onClick]);\n  return elemProps;\n};","map":{"version":3,"sources":["/Users/janet.xuishi/node_modules/@workday/canvas-kit-react/dist/es6/popup/lib/hooks/useCloseOnOutsideClick.js"],"names":["React","PopupStack","useCloseOnOutsideClick","model","elemProps","onClick","useCallback","event","state","stackRef","current","elements","getElements","filter","e","getAttribute","sort","a","b","Number","style","zIndex","length","contains","target","events","hide","visible","visibility","useLayoutEffect","_a","document","addEventListener","setAttribute","removeEventListener"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,iCAA3B;AACA,OAAO,IAAIC,sBAAsB,GAAG,UAAUC,KAAV,EAAiBC,SAAjB,EAA4B;AAC5D,MAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AAAEA,IAAAA,SAAS,GAAG,EAAZ;AAAiB;;AAC7C,MAAIC,OAAO,GAAGL,KAAK,CAACM,WAAN,CAAkB,UAAUC,KAAV,EAAiB;AAC7C,QAAI,CAACJ,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAA1B,EAAmC;AAC/B;AACH;;AACD,QAAIC,QAAQ,GAAGV,UAAU,CAACW,WAAX,GACVC,MADU,CACH,UAAUC,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACC,YAAF,CAAe,mCAAf,MAAwD,SAA/D;AAA2E,KADvF,EAEVC,IAFU,CAEL,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,aAAOC,MAAM,CAACF,CAAC,CAACG,KAAF,CAAQC,MAAT,CAAN,GAAyBF,MAAM,CAACD,CAAC,CAACE,KAAF,CAAQC,MAAT,CAAtC;AAAyD,KAFtE,CAAf;;AAGA,QAAIV,QAAQ,CAACW,MAAT,IACAX,QAAQ,CAACA,QAAQ,CAACW,MAAT,GAAkB,CAAnB,CAAR,KAAkCnB,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OADvD,IAEA,CAACT,UAAU,CAACsB,QAAX,CAAoBpB,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAAzC,EAAkDH,KAAK,CAACiB,MAAxD,CAFL,EAEsE;AAClErB,MAAAA,KAAK,CAACsB,MAAN,CAAaC,IAAb,CAAkB;AAAEnB,QAAAA,KAAK,EAAEA;AAAT,OAAlB;AACH;AACJ,GAZa,EAYX,CAACJ,KAAK,CAACK,KAAN,CAAYC,QAAb,EAAuBN,KAAK,CAACsB,MAA7B,CAZW,CAAd;AAaA,MAAIE,OAAO,GAAGxB,KAAK,CAACK,KAAN,CAAYoB,UAAZ,KAA2B,QAAzC;AACA5B,EAAAA,KAAK,CAAC6B,eAAN,CAAsB,YAAY;AAC9B,QAAIC,EAAJ;;AACA,QAAI,CAACH,OAAL,EAAc;AACV;AACH;;AACDI,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,EAAuC3B,OAAvC;AACA,KAACyB,EAAE,GAAG3B,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAA3B,MAAwC,IAAxC,IAAgDoB,EAAE,KAAK,KAAK,CAA5D,GAAgE,KAAK,CAArE,GAAyEA,EAAE,CAACG,YAAH,CAAgB,mCAAhB,EAAqD,SAArD,CAAzE;AACA,WAAO,YAAY;AACfF,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,WAA7B,EAA0C7B,OAA1C;AACH,KAFD;AAGH,GAVD,EAUG,CAACF,KAAK,CAACK,KAAN,CAAYC,QAAb,EAAuBkB,OAAvB,EAAgCtB,OAAhC,CAVH;AAWA,SAAOD,SAAP;AACH,CA5BM","sourcesContent":["import React from 'react';\nimport { PopupStack } from '@workday/canvas-kit-popup-stack';\nexport var useCloseOnOutsideClick = function (model, elemProps) {\n    if (elemProps === void 0) { elemProps = {}; }\n    var onClick = React.useCallback(function (event) {\n        if (!model.state.stackRef.current) {\n            return;\n        }\n        var elements = PopupStack.getElements()\n            .filter(function (e) { return e.getAttribute('data-behavior-click-outside-close') === 'topmost'; })\n            .sort(function (a, b) { return Number(a.style.zIndex) - Number(b.style.zIndex); });\n        if (elements.length &&\n            elements[elements.length - 1] === model.state.stackRef.current &&\n            !PopupStack.contains(model.state.stackRef.current, event.target)) {\n            model.events.hide({ event: event });\n        }\n    }, [model.state.stackRef, model.events]);\n    var visible = model.state.visibility !== 'hidden';\n    React.useLayoutEffect(function () {\n        var _a;\n        if (!visible) {\n            return;\n        }\n        document.addEventListener('mousedown', onClick);\n        (_a = model.state.stackRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-behavior-click-outside-close', 'topmost');\n        return function () {\n            document.removeEventListener('mousedown', onClick);\n        };\n    }, [model.state.stackRef, visible, onClick]);\n    return elemProps;\n};\n"]},"metadata":{},"sourceType":"module"}