{"ast":null,"code":"import React from 'react';\nimport { PopupStack } from '@workday/canvas-kit-popup-stack';\nexport var useCloseOnOverlayClick = function (model, elemProps) {\n  if (elemProps === void 0) {\n    elemProps = {};\n  }\n\n  var onClick = React.useCallback(function (event) {\n    if (!model.state.stackRef.current) {\n      return;\n    }\n\n    var elements = PopupStack.getElements().filter(function (e) {\n      return e.getAttribute('data-behavior-click-outside-close') === 'topmost';\n    }).sort(function (a, b) {\n      return Number(a.style.zIndex) - Number(b.style.zIndex);\n    });\n    var dialog = model.state.stackRef.current.querySelector('[role=dialog]');\n    var elementsBetweenDialogAnBody = [];\n    var element = dialog;\n\n    while (element === null || element === void 0 ? void 0 : element.parentElement) {\n      elementsBetweenDialogAnBody.push(element.parentElement);\n      element = (element === null || element === void 0 ? void 0 : element.parentElement) || null;\n    }\n\n    if (dialog && elements.length && elements[elements.length - 1] === model.state.stackRef.current && elementsBetweenDialogAnBody.some(function (element) {\n      return element === event.target;\n    })) {\n      model.events.hide({\n        event: event\n      });\n    }\n  }, [model.state.stackRef, model.events]);\n  var visible = model.state.visibility !== 'hidden';\n  React.useLayoutEffect(function () {\n    var _a;\n\n    if (!visible) {\n      return;\n    }\n\n    document.addEventListener('mousedown', onClick);\n    (_a = model.state.stackRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-behavior-click-outside-close', 'topmost');\n    return function () {\n      document.removeEventListener('mousedown', onClick);\n    };\n  }, [model.state.stackRef, visible, onClick]);\n  return elemProps;\n};","map":{"version":3,"sources":["/Users/janet.xuishi/node_modules/@workday/canvas-kit-react/dist/es6/modal/lib/hooks/useCloseOnOverlayClick.js"],"names":["React","PopupStack","useCloseOnOverlayClick","model","elemProps","onClick","useCallback","event","state","stackRef","current","elements","getElements","filter","e","getAttribute","sort","a","b","Number","style","zIndex","dialog","querySelector","elementsBetweenDialogAnBody","element","parentElement","push","length","some","target","events","hide","visible","visibility","useLayoutEffect","_a","document","addEventListener","setAttribute","removeEventListener"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,iCAA3B;AACA,OAAO,IAAIC,sBAAsB,GAAG,UAAUC,KAAV,EAAiBC,SAAjB,EAA4B;AAC5D,MAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AAAEA,IAAAA,SAAS,GAAG,EAAZ;AAAiB;;AAC7C,MAAIC,OAAO,GAAGL,KAAK,CAACM,WAAN,CAAkB,UAAUC,KAAV,EAAiB;AAC7C,QAAI,CAACJ,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAA1B,EAAmC;AAC/B;AACH;;AACD,QAAIC,QAAQ,GAAGV,UAAU,CAACW,WAAX,GACVC,MADU,CACH,UAAUC,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACC,YAAF,CAAe,mCAAf,MAAwD,SAA/D;AAA2E,KADvF,EAEVC,IAFU,CAEL,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,aAAOC,MAAM,CAACF,CAAC,CAACG,KAAF,CAAQC,MAAT,CAAN,GAAyBF,MAAM,CAACD,CAAC,CAACE,KAAF,CAAQC,MAAT,CAAtC;AAAyD,KAFtE,CAAf;AAGA,QAAIC,MAAM,GAAGnB,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAArB,CAA6Ba,aAA7B,CAA2C,eAA3C,CAAb;AACA,QAAIC,2BAA2B,GAAG,EAAlC;AACA,QAAIC,OAAO,GAAGH,MAAd;;AACA,WAAOG,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAK,KAAK,CAArC,GAAyC,KAAK,CAA9C,GAAkDA,OAAO,CAACC,aAAjE,EAAgF;AAC5EF,MAAAA,2BAA2B,CAACG,IAA5B,CAAiCF,OAAO,CAACC,aAAzC;AACAD,MAAAA,OAAO,GAAG,CAACA,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAK,KAAK,CAArC,GAAyC,KAAK,CAA9C,GAAkDA,OAAO,CAACC,aAA3D,KAA6E,IAAvF;AACH;;AACD,QAAIJ,MAAM,IACNX,QAAQ,CAACiB,MADT,IAEAjB,QAAQ,CAACA,QAAQ,CAACiB,MAAT,GAAkB,CAAnB,CAAR,KAAkCzB,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAFvD,IAGAc,2BAA2B,CAACK,IAA5B,CAAiC,UAAUJ,OAAV,EAAmB;AAAE,aAAOA,OAAO,KAAKlB,KAAK,CAACuB,MAAzB;AAAkC,KAAxF,CAHJ,EAG+F;AAC3F3B,MAAAA,KAAK,CAAC4B,MAAN,CAAaC,IAAb,CAAkB;AAAEzB,QAAAA,KAAK,EAAEA;AAAT,OAAlB;AACH;AACJ,GApBa,EAoBX,CAACJ,KAAK,CAACK,KAAN,CAAYC,QAAb,EAAuBN,KAAK,CAAC4B,MAA7B,CApBW,CAAd;AAqBA,MAAIE,OAAO,GAAG9B,KAAK,CAACK,KAAN,CAAY0B,UAAZ,KAA2B,QAAzC;AACAlC,EAAAA,KAAK,CAACmC,eAAN,CAAsB,YAAY;AAC9B,QAAIC,EAAJ;;AACA,QAAI,CAACH,OAAL,EAAc;AACV;AACH;;AACDI,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,EAAuCjC,OAAvC;AACA,KAAC+B,EAAE,GAAGjC,KAAK,CAACK,KAAN,CAAYC,QAAZ,CAAqBC,OAA3B,MAAwC,IAAxC,IAAgD0B,EAAE,KAAK,KAAK,CAA5D,GAAgE,KAAK,CAArE,GAAyEA,EAAE,CAACG,YAAH,CAAgB,mCAAhB,EAAqD,SAArD,CAAzE;AACA,WAAO,YAAY;AACfF,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,WAA7B,EAA0CnC,OAA1C;AACH,KAFD;AAGH,GAVD,EAUG,CAACF,KAAK,CAACK,KAAN,CAAYC,QAAb,EAAuBwB,OAAvB,EAAgC5B,OAAhC,CAVH;AAWA,SAAOD,SAAP;AACH,CApCM","sourcesContent":["import React from 'react';\nimport { PopupStack } from '@workday/canvas-kit-popup-stack';\nexport var useCloseOnOverlayClick = function (model, elemProps) {\n    if (elemProps === void 0) { elemProps = {}; }\n    var onClick = React.useCallback(function (event) {\n        if (!model.state.stackRef.current) {\n            return;\n        }\n        var elements = PopupStack.getElements()\n            .filter(function (e) { return e.getAttribute('data-behavior-click-outside-close') === 'topmost'; })\n            .sort(function (a, b) { return Number(a.style.zIndex) - Number(b.style.zIndex); });\n        var dialog = model.state.stackRef.current.querySelector('[role=dialog]');\n        var elementsBetweenDialogAnBody = [];\n        var element = dialog;\n        while (element === null || element === void 0 ? void 0 : element.parentElement) {\n            elementsBetweenDialogAnBody.push(element.parentElement);\n            element = (element === null || element === void 0 ? void 0 : element.parentElement) || null;\n        }\n        if (dialog &&\n            elements.length &&\n            elements[elements.length - 1] === model.state.stackRef.current &&\n            elementsBetweenDialogAnBody.some(function (element) { return element === event.target; })) {\n            model.events.hide({ event: event });\n        }\n    }, [model.state.stackRef, model.events]);\n    var visible = model.state.visibility !== 'hidden';\n    React.useLayoutEffect(function () {\n        var _a;\n        if (!visible) {\n            return;\n        }\n        document.addEventListener('mousedown', onClick);\n        (_a = model.state.stackRef.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-behavior-click-outside-close', 'topmost');\n        return function () {\n            document.removeEventListener('mousedown', onClick);\n        };\n    }, [model.state.stackRef, visible, onClick]);\n    return elemProps;\n};\n"]},"metadata":{},"sourceType":"module"}